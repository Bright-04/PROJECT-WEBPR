version: "3.8"

services:
    app:
        # Development-specific overrides
        environment:
            - NODE_ENV=development
        volumes:
            # Mount source code for live reloading
            - ./src:/app/src
            - ./uploads:/app/uploads
            - ./src/public/img:/app/src/public/img:ro
            # Exclude node_modules from volume mount
            - /app/node_modules
        # Use nodemon for development
        command: ["npm", "start"]
        # Development-specific health check
        healthcheck:
            test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:3000/health"]
            interval: 10s
            timeout: 5s
            retries: 5
            start_period: 30s
