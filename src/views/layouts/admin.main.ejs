<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Admin Dashboard - DHLQS News</title>

		<!-- Google Fonts -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />

		<!-- Bootstrap CSS -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

		<!-- Bootstrap Icons -->
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />

		<!-- Design System -->
		<link rel="stylesheet" href="/css/design-system.css" />

		<!-- Custom Styles -->
		<link rel="stylesheet" href="/css/layouts/admin.main.css" />

		<!-- Favicon -->
		<link rel="icon" type="image/png" href="/img/logo/logo.png" />
	</head>

	<body class="admin-body">
		<div class="admin-wrapper">
			<!-- Sidebar -->
			<% if (user.user_role === 'admin') { %>
			<aside id="sidebar" class="admin-sidebar">
				<div class="sidebar-header">
					<div class="sidebar-brand">
						<img src="/img/logo/logo.png" alt="DHLQS News" height="40" class="me-3" />
						<div>
							<h5 class="mb-0 text-white fw-bold">Admin Panel</h5>
							<small class="text-gray-400">DHLQS News</small>
						</div>
					</div>
					<button id="sidebarClose" class="sidebar-close">
						<i class="bi bi-x-lg"></i>
					</button>
				</div>

				<nav class="sidebar-nav">
					<div class="nav-section">
						<h6 class="nav-section-title">Dashboard</h6>
						<ul class="nav-list">
							<li class="nav-item">
								<a href="/admin" class="nav-link">
									<i class="bi bi-speedometer2"></i>
									<span>Tổng quan</span>
								</a>
							</li>
						</ul>
					</div>

					<div class="nav-section">
						<h6 class="nav-section-title">Quản lý nội dung</h6>
						<ul class="nav-list">
							<li class="nav-item">
								<a href="/admin/writers" class="nav-link">
									<i class="bi bi-pencil-square"></i>
									<span>Nhà báo</span>
								</a>
							</li>
							<li class="nav-item">
								<a href="/admin/editor" class="nav-link">
									<i class="bi bi-person-workspace"></i>
									<span>Biên tập viên</span>
								</a>
							</li>
							<li class="nav-item">
								<a href="/admin/readers" class="nav-link">
									<i class="bi bi-people"></i>
									<span>Độc giả</span>
								</a>
							</li>
						</ul>
					</div>

					<div class="nav-section">
						<h6 class="nav-section-title">Cấu hình</h6>
						<ul class="nav-list">
							<li class="nav-item">
								<a href="/admin/categories" class="nav-link">
									<i class="bi bi-tags"></i>
									<span>Danh mục</span>
								</a>
							</li>
							<li class="nav-item">
								<a href="/admin/tags" class="nav-link">
									<i class="bi bi-hash"></i>
									<span>Thẻ</span>
								</a>
							</li>
						</ul>
					</div>
				</nav>

				<div class="sidebar-footer">
					<div class="user-info">
						<div class="user-avatar">
							<i class="bi bi-person-circle"></i>
						</div>
						<div class="user-details">
							<h6 class="user-name"><%= user.full_name %></h6>
							<span class="user-role"><%= user.user_role %></span>
						</div>
					</div>
					<a href="/logout" class="logout-btn">
						<i class="bi bi-box-arrow-right"></i>
						<span>Đăng xuất</span>
					</a>
				</div>
			</aside>
			<% } %>

			<!-- Main Content -->
			<main id="content" class="admin-content">
				<!-- Header -->
				<header class="admin-header">
					<div class="header-left">
						<% if (user.user_role === 'admin') { %>
						<button id="sidebarOpen" class="sidebar-toggle">
							<i class="bi bi-list"></i>
						</button>
						<% } %>
						<div class="breadcrumb">
							<nav aria-label="breadcrumb">
								<ol class="breadcrumb-list">
									<li class="breadcrumb-item">
										<a href="/admin">Dashboard</a>
									</li>
									<li class="breadcrumb-item active" aria-current="page"><%= typeof pageTitle !== 'undefined' ? pageTitle : 'Trang hiện tại' %></li>
								</ol>
							</nav>
						</div>
					</div>

					<div class="header-right">
						<div class="header-actions">
							<div class="notification-dropdown">
								<button class="notification-btn" data-bs-toggle="dropdown">
									<i class="bi bi-bell"></i>
									<span class="notification-badge">3</span>
								</button>
								<div class="dropdown-menu dropdown-menu-end notification-menu">
									<div class="notification-header">
										<h6>Thông báo</h6>
										<a href="#" class="mark-all-read">Đánh dấu đã đọc</a>
									</div>
									<div class="notification-list">
										<div class="notification-item unread">
											<div class="notification-icon">
												<i class="bi bi-file-earmark-text text-primary"></i>
											</div>
											<div class="notification-content">
												<p>Bài viết mới cần duyệt</p>
												<small>2 phút trước</small>
											</div>
										</div>
										<div class="notification-item unread">
											<div class="notification-icon">
												<i class="bi bi-person-plus text-success"></i>
											</div>
											<div class="notification-content">
												<p>Người dùng mới đăng ký</p>
												<small>5 phút trước</small>
											</div>
										</div>
										<div class="notification-item">
											<div class="notification-icon">
												<i class="bi bi-star text-warning"></i>
											</div>
											<div class="notification-content">
												<p>Bài viết được đánh giá cao</p>
												<small>10 phút trước</small>
											</div>
										</div>
									</div>
									<div class="notification-footer">
										<a href="#" class="view-all">Xem tất cả thông báo</a>
									</div>
								</div>
							</div>

							<div class="user-dropdown">
								<button class="user-btn" data-bs-toggle="dropdown">
									<div class="user-avatar-sm">
										<i class="bi bi-person-circle"></i>
									</div>
									<span class="user-name-sm"><%= user.full_name %></span>
									<i class="bi bi-chevron-down"></i>
								</button>
								<div class="dropdown-menu dropdown-menu-end user-menu">
									<div class="user-menu-header">
										<div class="user-avatar-menu">
											<i class="bi bi-person-circle"></i>
										</div>
										<div class="user-info-menu">
											<h6><%= user.full_name %></h6>
											<span><%= user.email %></span>
										</div>
									</div>
									<div class="user-menu-body">
										<a href="/profile" class="menu-item">
											<i class="bi bi-person"></i>
											<span>Hồ sơ cá nhân</span>
										</a>
										<a href="#" class="menu-item">
											<i class="bi bi-gear"></i>
											<span>Cài đặt</span>
										</a>
										<a href="#" class="menu-item">
											<i class="bi bi-question-circle"></i>
											<span>Trợ giúp</span>
										</a>
									</div>
									<div class="user-menu-footer">
										<a href="/logout" class="menu-item text-danger">
											<i class="bi bi-box-arrow-right"></i>
											<span>Đăng xuất</span>
										</a>
									</div>
								</div>
							</div>
						</div>
					</div>
				</header>

				<!-- Page Content -->
				<div class="page-content"><%- body %></div>
			</main>
		</div>

		<!-- Scripts -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

		<!-- Custom Scripts -->
		<script>
			document.addEventListener("DOMContentLoaded", function () {
				const sidebar = document.getElementById("sidebar");
				const content = document.getElementById("content");
				const sidebarOpen = document.getElementById("sidebarOpen");
				const sidebarClose = document.getElementById("sidebarClose");

				if (sidebar && sidebarOpen && sidebarClose) {
					// Toggle sidebar
					sidebarOpen.addEventListener("click", function () {
						sidebar.classList.add("active");
						content.classList.add("sidebar-active");
					});

					sidebarClose.addEventListener("click", function () {
						sidebar.classList.remove("active");
						content.classList.remove("sidebar-active");
					});

					// Close sidebar on mobile when clicking outside
					document.addEventListener("click", function (e) {
						if (window.innerWidth <= 768) {
							if (!sidebar.contains(e.target) && !sidebarOpen.contains(e.target)) {
								sidebar.classList.remove("active");
								content.classList.remove("sidebar-active");
							}
						}
					});

					// Handle window resize
					window.addEventListener("resize", function () {
						if (window.innerWidth > 768) {
							sidebar.classList.remove("active");
							content.classList.remove("sidebar-active");
						}
					});
				}

				// Add active class to current nav item
				const currentPath = window.location.pathname;
				const navLinks = document.querySelectorAll(".nav-link");

				navLinks.forEach((link) => {
					if (link.getAttribute("href") === currentPath) {
						link.classList.add("active");
					}
				});

				// Notification functionality
				const notificationItems = document.querySelectorAll(".notification-item.unread");
				const notificationBadge = document.querySelector(".notification-badge");

				notificationItems.forEach((item) => {
					item.addEventListener("click", function () {
						this.classList.remove("unread");
						updateNotificationCount();
					});
				});

				function updateNotificationCount() {
					const unreadCount = document.querySelectorAll(".notification-item.unread").length;
					if (notificationBadge) {
						notificationBadge.textContent = unreadCount;
						if (unreadCount === 0) {
							notificationBadge.style.display = "none";
						}
					}
				}
			});
		</script>
	</body>
</html>
